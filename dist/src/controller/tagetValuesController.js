const a7_0x17f5e0=a7_0xf9a0;(function(_0x94813a,_0xa13055){const _0x1e92c3=a7_0xf9a0,_0x896f0c=_0x94813a();while(!![]){try{const _0x427ad7=parseInt(_0x1e92c3(0xe1))/0x1+-parseInt(_0x1e92c3(0xd7))/0x2+-parseInt(_0x1e92c3(0x103))/0x3*(parseInt(_0x1e92c3(0xdc))/0x4)+-parseInt(_0x1e92c3(0xf4))/0x5+parseInt(_0x1e92c3(0xfb))/0x6+-parseInt(_0x1e92c3(0xe8))/0x7+parseInt(_0x1e92c3(0x107))/0x8*(parseInt(_0x1e92c3(0x10b))/0x9);if(_0x427ad7===_0xa13055)break;else _0x896f0c['push'](_0x896f0c['shift']());}catch(_0x52e31){_0x896f0c['push'](_0x896f0c['shift']());}}}(a7_0x3db8,0xa465b));const axios=require(a7_0x17f5e0(0xdf)),SalesModel=require(a7_0x17f5e0(0xf2));function a7_0x3db8(){const _0x5744bb=['Gjahr','Bztxt','âš ï¸\x20No\x20valid\x20sales\x20data\x20received.','Invalid\x20data\x20format\x20received\x20from\x20SAP','SAP_USERNAME','env','âœ…\x20Sales\x20data\x20synced\x20successfully','âœ…\x20Sales\x20Data\x20Sync\x20Completed\x20Successfully','ðŸ”\x20Fetching\x20Sales\x20Data\x20from\x20API:','../models/tagetValuesModel','application/json','5106525SalKEs','length','insertOrUpdateSalesData','âŒ\x20Invalid\x20API\x20Response\x20Format:','\x20sales\x20data\x20entries...','TotalInvoice','ðŸ“¦\x20Processing\x20','5096664kpVZFE','data','ðŸ“Œ\x20API\x20Response\x20Data:','ðŸ“¦\x20Received\x20','processedRows','message','âŒ\x20Error\x20fetching\x20SAP\x20sales\x20data:','âš ï¸\x20Received\x20empty\x20response\x20from\x20API','17916xJCswW','âŒ\x20Error\x20syncing\x20sales\x20data:','MonthD','failedRows','136GzcCwE','warn','Matkl','dotenv','1669779XOPqBP','âŒ\x20Skipping\x20invalid\x20entry\x20at\x20index\x20','\x20sales\x20data\x20entries','Unexpected\x20database\x20response','toString','SAP_PASSWORD','Empty\x20response\x20from\x20API','0.00','ðŸš€\x20Starting\x20Sales\x20Data\x20Sync...','error','object','...','2017008fPogJV','âœ…\x20API\x20Response\x20Received.Length:','status','âŒ\x20Error\x20inserting\x20or\x20updating\x20sales\x20data:','ðŸ“Œ\x20Final\x20Data\x20Before\x20Processing:','476lINMZI','results','slice','axios','success','123962IYgeVh','stringify','isArray','map','PlannedOrder','json','log','4995095HZVQNA'];a7_0x3db8=function(){return _0x5744bb;};return a7_0x3db8();}require(a7_0x17f5e0(0x10a))['config']();function a7_0xf9a0(_0x15601f,_0x3ac170){const _0x3db8ea=a7_0x3db8();return a7_0xf9a0=function(_0xf9a03b,_0x3cd32a){_0xf9a03b=_0xf9a03b-0xd5;let _0x3f046a=_0x3db8ea[_0xf9a03b];return _0x3f046a;},a7_0xf9a0(_0x15601f,_0x3ac170);}const API_URL=process['env']['TAGET_VALUES'],convertToDecimal=_0x3d40b6=>{const _0x1096f6=a7_0x17f5e0;if(!_0x3d40b6||isNaN(_0x3d40b6))return _0x1096f6(0x112);return parseFloat(_0x3d40b6[_0x1096f6(0x10f)]()['replace'](',','.'))['toFixed'](0x2);},fetchSAPSalesData=async()=>{const _0x39d11f=a7_0x17f5e0;try{console[_0x39d11f(0xe7)](_0x39d11f(0xf1),API_URL);const _0x21b103=await axios['get'](API_URL,{'auth':{'username':process[_0x39d11f(0xee)][_0x39d11f(0xed)],'password':process['env'][_0x39d11f(0x110)]},'headers':{'Accept':_0x39d11f(0xf3)}});if(!_0x21b103[_0x39d11f(0xfc)]){console[_0x39d11f(0x108)](_0x39d11f(0x102));throw new Error(_0x39d11f(0x111));}console['log'](_0x39d11f(0xd8),JSON[_0x39d11f(0xe2)](_0x21b103[_0x39d11f(0xfc)])[_0x39d11f(0xf5)]),console[_0x39d11f(0xe7)](_0x39d11f(0xfd),JSON[_0x39d11f(0xe2)](_0x21b103[_0x39d11f(0xfc)],null,0x2));const _0x360432=_0x21b103[_0x39d11f(0xfc)]?.['d']?.[_0x39d11f(0xdd)];if(!Array['isArray'](_0x360432)){console[_0x39d11f(0x114)](_0x39d11f(0xf7),JSON['stringify'](_0x21b103[_0x39d11f(0xfc)])[_0x39d11f(0xde)](0x0,0xc8)+_0x39d11f(0xd6));throw new Error(_0x39d11f(0xec));}return console[_0x39d11f(0xe7)](_0x39d11f(0xfe)+_0x360432[_0x39d11f(0xf5)]+_0x39d11f(0x10d)),_0x360432;}catch(_0x36cd9f){console[_0x39d11f(0x114)](_0x39d11f(0x101),_0x36cd9f[_0x39d11f(0x100)]);throw new Error('SAP\x20API\x20Error:\x20'+_0x36cd9f[_0x39d11f(0x100)]);}},fetchAndInsertSalesData=async(_0x4e47f1,_0x254f08)=>{const _0x1bef63=a7_0x17f5e0;try{console[_0x1bef63(0xe7)](_0x1bef63(0x113));const _0x496bc0=await fetchSAPSalesData();if(!Array[_0x1bef63(0xe3)](_0x496bc0)||_0x496bc0[_0x1bef63(0xf5)]===0x0){console['warn'](_0x1bef63(0xeb));if(_0x254f08)return _0x254f08['status'](0x190)[_0x1bef63(0xe6)]({'message':'No\x20sales\x20data\x20found\x20in\x20SAP'});return;}console['log'](_0x1bef63(0xfa)+_0x496bc0[_0x1bef63(0xf5)]+_0x1bef63(0xf8));const _0x1db71c=_0x496bc0[_0x1bef63(0xe4)]((_0x1fab80,_0x108b72)=>{const _0x24d15d=_0x1bef63;if(!_0x1fab80||typeof _0x1fab80!==_0x24d15d(0xd5))return console[_0x24d15d(0x114)](_0x24d15d(0x10c)+_0x108b72+':',_0x1fab80),null;return{'Gjahr':String(_0x1fab80?.[_0x24d15d(0xe9)]||''),'MonthD':String(_0x1fab80?.[_0x24d15d(0x105)]||''),'Bzirk':String(_0x1fab80?.['Bzirk']||''),'Matkl':String(_0x1fab80?.[_0x24d15d(0x109)]||''),'PlannedOrder':convertToDecimal(_0x1fab80?.[_0x24d15d(0xe5)]),'TotalInvoice':convertToDecimal(_0x1fab80?.[_0x24d15d(0xf9)]),'Wgbez':String(_0x1fab80?.['Wgbez']||''),'Bztxt':String(_0x1fab80?.[_0x24d15d(0xea)]||'')};})['filter'](Boolean);console[_0x1bef63(0xe7)](_0x1bef63(0xdb),JSON[_0x1bef63(0xe2)](_0x1db71c,null,0x2));const _0x37a53e=await SalesModel[_0x1bef63(0xf6)](_0x1db71c);if(!_0x37a53e||typeof _0x37a53e!==_0x1bef63(0xd5)||!_0x37a53e[_0x1bef63(0xe0)]){console[_0x1bef63(0x114)](_0x1bef63(0xda),_0x37a53e?.[_0x1bef63(0x114)]||_0x1bef63(0x10e));if(_0x254f08)return _0x254f08[_0x1bef63(0xd9)](0x1f4)['json']({'message':'Error\x20inserting\x20or\x20updating\x20sales\x20data','error':_0x37a53e?.[_0x1bef63(0x114)]||'Database\x20error'});return;}console['log'](_0x1bef63(0xf0));if(_0x254f08)return _0x254f08['status'](0xc8)[_0x1bef63(0xe6)]({'message':_0x1bef63(0xef),'insertedRows':_0x37a53e[_0x1bef63(0xff)][_0x1bef63(0xf5)],'updatedRows':_0x37a53e[_0x1bef63(0xff)][_0x1bef63(0xf5)],'failedRows':_0x37a53e[_0x1bef63(0x106)][_0x1bef63(0xf5)],'errors':_0x37a53e[_0x1bef63(0x106)]});}catch(_0x9cc9d){console[_0x1bef63(0x114)](_0x1bef63(0x104),_0x9cc9d[_0x1bef63(0x100)]);if(_0x254f08)return _0x254f08[_0x1bef63(0xd9)](0x1f4)['json']({'message':'Internal\x20Server\x20Error','error':_0x9cc9d[_0x1bef63(0x100)]});}};module['exports']={'fetchAndInsertSalesData':fetchAndInsertSalesData};