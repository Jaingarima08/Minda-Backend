const a4_0x395523=a4_0x1c29;function a4_0x1c29(_0x4a3045,_0x24397d){const _0x53f192=a4_0x53f1();return a4_0x1c29=function(_0x1c2956,_0x59b514){_0x1c2956=_0x1c2956-0x190;let _0x2dc894=_0x53f192[_0x1c2956];return _0x2dc894;},a4_0x1c29(_0x4a3045,_0x24397d);}(function(_0x30cca2,_0x24653c){const _0x509de6=a4_0x1c29,_0x59c880=_0x30cca2();while(!![]){try{const _0x384739=-parseInt(_0x509de6(0x1b8))/0x1+parseInt(_0x509de6(0x1c8))/0x2+-parseInt(_0x509de6(0x19c))/0x3*(parseInt(_0x509de6(0x1ab))/0x4)+parseInt(_0x509de6(0x19f))/0x5*(parseInt(_0x509de6(0x1b9))/0x6)+-parseInt(_0x509de6(0x1b6))/0x7+-parseInt(_0x509de6(0x1ac))/0x8+parseInt(_0x509de6(0x196))/0x9;if(_0x384739===_0x24653c)break;else _0x59c880['push'](_0x59c880['shift']());}catch(_0xc19f7a){_0x59c880['push'](_0x59c880['shift']());}}}(a4_0x53f1,0xea964));const axios=require(a4_0x395523(0x1c5)),{insertOrUpdateSalesData}=require(a4_0x395523(0x1be));function a4_0x53f1(){const _0x28f106=['ProdCatgry','API\x20Response\x20Data:','Lzone','replace','Ernam','Internal\x20Server\x20Error','axios','exports','PlanOrderQuantity','3061670RMpwiu','error','Unexpected\x20database\x20response','Starting\x20Sales\x20Data\x20Sync...','get','data','❌\x20Error\x20syncing\x20sales\x20data:','length','API\x20Response\x20Received.Length:','success','23870979VvVMdS','filter','0.00','Gjahr','MonthD','Database\x20error','405BvsooB','SAP_API_URL','entries','65wjnZFa','\x20Received\x20empty\x20response\x20from\x20API','split','🔍\x20Fetching\x20Data\x20from\x20API:','\x20sales\x20data\x20from\x20API','isArray','match','failedRows','❌\x20Invalid\x20API\x20response\x20format:','processedRows','SAP_PASSWORD','stringify','54608vqBZbj','5063752TfGffT','env','trim','map','toISOString','toString','Sales\x20data\x20synced\x20successfully','SAP\x20API\x20ERROR:\x20','log','message','4927685qMMaZt','Empty\x20response\x20from\x20API','1460693ZRrVuf','654618xIGiAc','json','Processing\x20Sales\x20Data\x20','\x20Sales\x20Data\x20Sync\x20Completed\x20Successfully\x20','toFixed','../models/salesModel'];a4_0x53f1=function(){return _0x28f106;};return a4_0x53f1();}require('dotenv')['config']();const API_URL=process['env'][a4_0x395523(0x19d)],convertSAPDateTime=_0x1478dd=>{const _0xd2ceeb=a4_0x395523;if(!_0x1478dd)return null;const _0x131d95=_0x1478dd[_0xd2ceeb(0x1a5)](/\d+/);if(!_0x131d95)return null;const _0x236a8b=parseInt(_0x131d95[0x0],0xa),_0x432bdd=new Date(_0x236a8b);return _0x432bdd[_0xd2ceeb(0x1b0)]()[_0xd2ceeb(0x1c2)]('T','\x20')[_0xd2ceeb(0x1a1)]('.')[0x0];},convertToDecimal=_0x2fe7d3=>{const _0x325fe9=a4_0x395523;if(!_0x2fe7d3||isNaN(_0x2fe7d3))return _0x325fe9(0x198);return parseFloat(_0x2fe7d3[_0x325fe9(0x1b1)]()[_0x325fe9(0x1c2)](',','.'))[_0x325fe9(0x1bd)](0x2);},formatProdCatgry=_0x313783=>{const _0x24322f=a4_0x395523;if(_0x313783===null||_0x313783===undefined)return'UNKNOWN';return String(_0x313783)[_0x24322f(0x1ae)]();},fetchSAPSalesData=async(_0x48bec3,_0x31055b)=>{const _0x3b9dac=a4_0x395523;try{console[_0x3b9dac(0x1b4)](_0x3b9dac(0x1a2),API_URL);const _0x4de086=await axios[_0x3b9dac(0x190)](API_URL,{'auth':{'username':process[_0x3b9dac(0x1ad)]['SAP_USERNAME'],'password':process[_0x3b9dac(0x1ad)][_0x3b9dac(0x1a9)]},'headers':{'Accept':'application/json'},'responseType':_0x3b9dac(0x1ba)});if(!_0x4de086[_0x3b9dac(0x191)]){console['warn'](_0x3b9dac(0x1a0));throw new Error(_0x3b9dac(0x1b7));}return console[_0x3b9dac(0x1b4)](_0x3b9dac(0x194),JSON[_0x3b9dac(0x1aa)](_0x4de086['data'])[_0x3b9dac(0x193)]),console[_0x3b9dac(0x1b4)](_0x3b9dac(0x1c0),JSON['stringify'](_0x4de086[_0x3b9dac(0x191)],null,0x2)),_0x4de086[_0x3b9dac(0x191)];}catch(_0x332ba0){console[_0x3b9dac(0x1c9)]('\x20Error\x20fetching\x20sales\x20data:',_0x332ba0['message']);throw new Error(_0x3b9dac(0x1b3)+_0x332ba0[_0x3b9dac(0x1b5)]);}},fetchAndInsertData=async(_0x41ede7,_0x36fc32)=>{const _0x4ba344=a4_0x395523;try{console[_0x4ba344(0x1b4)](_0x4ba344(0x1cb));const _0x484bc2=await fetchSAPSalesData();if(!_0x484bc2||!Array[_0x4ba344(0x1a4)](_0x484bc2))return console[_0x4ba344(0x1c9)](_0x4ba344(0x1a7),response[_0x4ba344(0x19e)]),_0x36fc32['status'](0x190)[_0x4ba344(0x1ba)]({'message':'Invalid\x20API\x20response\x20format'});console['log']('\x20Received\x20'+_0x484bc2[_0x4ba344(0x193)]+_0x4ba344(0x1a3));const _0x4bc6d8=_0x484bc2[_0x4ba344(0x1af)]((_0x39ebf6,_0x206766)=>{const _0x3cd74b=_0x4ba344;return console['log'](_0x3cd74b(0x1bb)+(_0x206766+0x1)+':',_0x39ebf6[_0x3cd74b(0x199)]),{'Gjahr':String(_0x39ebf6[_0x3cd74b(0x199)]),'MonthD':String(_0x39ebf6[_0x3cd74b(0x19a)]),'Lzone':String(_0x39ebf6[_0x3cd74b(0x1c1)]),'ProdCatgry':formatProdCatgry(_0x39ebf6[_0x3cd74b(0x1bf)]),'PlanOrderQuantity':convertToDecimal(_0x39ebf6[_0x3cd74b(0x1c7)]),'Budget':convertToDecimal(_0x39ebf6['Budget']),'Erdat':convertSAPDateTime(_0x39ebf6['Erdat']),'Ernam':String(_0x39ebf6[_0x3cd74b(0x1c3)])};})[_0x4ba344(0x197)](Boolean);console[_0x4ba344(0x1b4)]('📌\x20Final\x20Data\x20Before\x20Insertion:',JSON[_0x4ba344(0x1aa)](_0x4bc6d8,null,0x2));const _0x452a10=await insertOrUpdateSalesData(_0x4bc6d8);if(!_0x452a10||typeof _0x452a10!=='object'||!_0x452a10[_0x4ba344(0x195)]){console[_0x4ba344(0x1c9)]('\x20Error\x20inserted\x20or\x20updating\x20sales\x20data:',_0x452a10?.[_0x4ba344(0x1c9)]||_0x4ba344(0x1ca));if(_0x36fc32)return _0x36fc32['status'](0x1f4)['json']({'message':'Error\x20inserting\x20or\x20updating\x20sales\x20data','error':_0x452a10?.[_0x4ba344(0x1c9)]||_0x4ba344(0x19b)});return;}console[_0x4ba344(0x1b4)](_0x4ba344(0x1bc));if(_0x36fc32)return _0x36fc32['status'](0xc8)[_0x4ba344(0x1ba)]({'message':_0x4ba344(0x1b2),'insertedRows':_0x452a10[_0x4ba344(0x1a8)]['length'],'updatedRows':_0x452a10[_0x4ba344(0x1a8)][_0x4ba344(0x193)],'failedRows':_0x452a10['failedRows'][_0x4ba344(0x193)],'errors':_0x452a10[_0x4ba344(0x1a6)]});}catch(_0x3f382e){console[_0x4ba344(0x1c9)](_0x4ba344(0x192),_0x3f382e[_0x4ba344(0x1b5)]);if(_0x36fc32)return _0x36fc32['status'](0x1f4)['json']({'message':_0x4ba344(0x1c4),'error':_0x3f382e['message']});}};module[a4_0x395523(0x1c6)]={'fetchAndInsertData':fetchAndInsertData};