function a5_0x3d9f(_0x5790f1,_0x1523b7){const _0x3dd1bf=a5_0x3dd1();return a5_0x3d9f=function(_0x3d9f90,_0x301ac6){_0x3d9f90=_0x3d9f90-0xc8;let _0x2c45fd=_0x3dd1bf[_0x3d9f90];return _0x2c45fd;},a5_0x3d9f(_0x5790f1,_0x1523b7);}const a5_0x42e955=a5_0x3d9f;(function(_0x3cb363,_0x4618fb){const _0x5d33a8=a5_0x3d9f,_0x27451e=_0x3cb363();while(!![]){try{const _0x4880c5=parseInt(_0x5d33a8(0xdf))/0x1*(parseInt(_0x5d33a8(0x111))/0x2)+parseInt(_0x5d33a8(0xc9))/0x3+parseInt(_0x5d33a8(0xfe))/0x4+parseInt(_0x5d33a8(0xee))/0x5*(parseInt(_0x5d33a8(0x107))/0x6)+-parseInt(_0x5d33a8(0x102))/0x7*(parseInt(_0x5d33a8(0xd2))/0x8)+-parseInt(_0x5d33a8(0xdc))/0x9+-parseInt(_0x5d33a8(0xf2))/0xa*(parseInt(_0x5d33a8(0xe0))/0xb);if(_0x4880c5===_0x4618fb)break;else _0x27451e['push'](_0x27451e['shift']());}catch(_0xbf7482){_0x27451e['push'](_0x27451e['shift']());}}}(a5_0x3dd1,0xd6d9d));const axios=require(a5_0x42e955(0xd0)),{insertOrUpdateSalesInvoices}=require('../models/salesInvoiceModel');require('dotenv')[a5_0x42e955(0x10d)]();const API_URL=process['env'][a5_0x42e955(0xce)],convertSAPDateTime=_0x226306=>{const _0x4fc429=a5_0x42e955;if(!_0x226306||!_0x226306['match'](/\d+/))return null;const _0x2cb662=parseInt(_0x226306[_0x4fc429(0x109)](/\d+/)[0x0],0xa);return new Date(_0x2cb662)[_0x4fc429(0xf5)]()[_0x4fc429(0xde)]('T','\x20')[_0x4fc429(0xfc)]('.')[0x0];},convertToDecimal=_0x53159d=>{const _0x7c1e38=a5_0x42e955;if(!_0x53159d||isNaN(_0x53159d))return 0x0;return parseFloat(_0x53159d[_0x7c1e38(0xda)]()[_0x7c1e38(0xde)](',','.'));},fetchSAPSalesInvoices=async()=>{const _0x4e4b3e=a5_0x42e955;try{console[_0x4e4b3e(0xcb)]('üîç\x20Fetching\x20Sales\x20Invoice\x20Data\x20from\x20API:',API_URL);const _0x105c60=await axios[_0x4e4b3e(0xe5)](API_URL,{'auth':{'username':process[_0x4e4b3e(0xe4)]['SAP_USERNAME'],'password':process[_0x4e4b3e(0xe4)][_0x4e4b3e(0xf4)]},'headers':{'Accept':_0x4e4b3e(0xcc)},'responseType':'json'});if(!_0x105c60[_0x4e4b3e(0x104)]){console[_0x4e4b3e(0xfd)](_0x4e4b3e(0xf6));throw new Error(_0x4e4b3e(0xd4));}console[_0x4e4b3e(0xcb)](_0x4e4b3e(0x10b),JSON[_0x4e4b3e(0xd6)](_0x105c60[_0x4e4b3e(0x104)])[_0x4e4b3e(0xd7)]),console['log'](_0x4e4b3e(0xec),JSON[_0x4e4b3e(0xd6)](_0x105c60['data'],null,0x2));if(!_0x105c60['data']['d']||!Array[_0x4e4b3e(0xd5)](_0x105c60[_0x4e4b3e(0x104)]['d'][_0x4e4b3e(0xe3)])){console[_0x4e4b3e(0x110)](_0x4e4b3e(0xd9),JSON[_0x4e4b3e(0xd6)](_0x105c60[_0x4e4b3e(0x104)])['slice'](0x0,0xc8)+_0x4e4b3e(0x10a));throw new Error('Invalid\x20data\x20format\x20received\x20from\x20SAP');}const _0x3e6c5e=_0x105c60[_0x4e4b3e(0x104)]['d'][_0x4e4b3e(0xe3)]||[];return console[_0x4e4b3e(0xcb)]('üì¶\x20Received\x20'+_0x3e6c5e[_0x4e4b3e(0xd7)]+_0x4e4b3e(0xf9)),_0x3e6c5e;}catch(_0x263bc5){console[_0x4e4b3e(0x110)](_0x4e4b3e(0xe1),_0x263bc5[_0x4e4b3e(0xcf)]);throw new Error(_0x4e4b3e(0xdb)+_0x263bc5[_0x4e4b3e(0xcf)]);}},fetchAndStoreSalesInvoices=async(_0x1e2db3,_0x46b8ed)=>{const _0x3ea689=a5_0x42e955;try{console[_0x3ea689(0xcb)](_0x3ea689(0xc8));const _0x5e688a=await fetchSAPSalesInvoices();if(!Array[_0x3ea689(0xd5)](_0x5e688a)||_0x5e688a['length']===0x0){console['warn'](_0x3ea689(0xf1));if(_0x46b8ed)return _0x46b8ed[_0x3ea689(0x101)](0x190)[_0x3ea689(0xe6)]({'message':_0x3ea689(0xef)});return;}console[_0x3ea689(0xcb)](_0x3ea689(0xfa)+_0x5e688a[_0x3ea689(0xd7)]+_0x3ea689(0xe9));const _0x26a91b=_0x5e688a[_0x3ea689(0x106)]((_0x16166a,_0x5884a2)=>{const _0x36784b=_0x3ea689;if(!_0x16166a||typeof _0x16166a!==_0x36784b(0x10f))return console['error']('‚ùå\x20Skipping\x20invalid\x20invoice\x20at\x20index\x20'+_0x5884a2+':',_0x16166a),null;return{'Vbeln':String(_0x16166a?.[_0x36784b(0x108)]||''),'Posnr':String(_0x16166a?.[_0x36784b(0xeb)]||''),'Netwr':convertToDecimal(_0x16166a?.[_0x36784b(0xea)]),'Matnr':String(_0x16166a?.['Matnr']||''),'Matkl':String(_0x16166a?.[_0x36784b(0xed)]||''),'Fkart':String(_0x16166a?.[_0x36784b(0xd8)]||''),'Fktyp':String(_0x16166a?.[_0x36784b(0x105)]||''),'Vkorg':String(_0x16166a?.[_0x36784b(0xcd)]||''),'Waerk':String(_0x16166a?.[_0x36784b(0x103)]||''),'Gjahr':String(_0x16166a?.[_0x36784b(0xff)]||''),'Fkdat':convertSAPDateTime(_0x16166a?.[_0x36784b(0x100)]),'Aubel':String(_0x16166a?.[_0x36784b(0xdd)]||''),'Vtweg':String(_0x16166a?.[_0x36784b(0xf8)]||''),'Bzirk':String(_0x16166a?.['Bzirk']||''),'Spart':String(_0x16166a?.[_0x36784b(0xf0)]||''),'Aupos':String(_0x16166a?.[_0x36784b(0xfb)]||''),'Werks':String(_0x16166a?.[_0x36784b(0x10c)]||''),'Kunag':String(_0x16166a?.[_0x36784b(0xf7)]||'')};})[_0x3ea689(0xe8)](Boolean);console[_0x3ea689(0xcb)](_0x3ea689(0x10e),JSON[_0x3ea689(0xd6)](_0x26a91b,null,0x2));const _0x488216=await insertOrUpdateSalesInvoices(_0x26a91b);if(!_0x488216||typeof _0x488216!==_0x3ea689(0x10f)||!_0x488216['success']){console[_0x3ea689(0x110)]('‚ùå\x20Error\x20inserting\x20or\x20updating\x20sales\x20invoice\x20data:',_0x488216?.[_0x3ea689(0x110)]||'Unexpected\x20database\x20response');if(_0x46b8ed)return _0x46b8ed['status'](0x1f4)[_0x3ea689(0xe6)]({'message':_0x3ea689(0xca),'error':_0x488216?.[_0x3ea689(0x110)]||'Database\x20error'});return;}console[_0x3ea689(0xcb)](_0x3ea689(0xe7));if(_0x46b8ed)return _0x46b8ed[_0x3ea689(0x101)](0xc8)[_0x3ea689(0xe6)]({'message':'‚úÖ\x20Sales\x20invoice\x20data\x20synced\x20successfully','insertedRows':_0x488216['processedRows']['length'],'updatedRows':_0x488216[_0x3ea689(0xd3)][_0x3ea689(0xd7)],'failedRows':_0x488216[_0x3ea689(0xd1)][_0x3ea689(0xd7)],'errors':_0x488216[_0x3ea689(0xd1)]});}catch(_0x2ccd7d){console[_0x3ea689(0x110)](_0x3ea689(0xf3),_0x2ccd7d[_0x3ea689(0xcf)]);if(_0x46b8ed)return _0x46b8ed[_0x3ea689(0x101)](0x1f4)[_0x3ea689(0xe6)]({'message':_0x3ea689(0xe2),'error':_0x2ccd7d[_0x3ea689(0xcf)]});}};module['exports']={'fetchAndStoreSalesInvoices':fetchAndStoreSalesInvoices};function a5_0x3dd1(){const _0x221194=['‚ùå\x20Error\x20syncing\x20sales\x20invoice\x20data:','SAP_PASSWORD','toISOString','‚ö†Ô∏è\x20Received\x20empty\x20response\x20from\x20API','Kunag','Vtweg','\x20sales\x20invoices','üì¶\x20Processing\x20','Aupos','split','warn','5622848PJbwYz','Gjahr','Fkdat','status','14wpHkzb','Waerk','data','Fktyp','map','2179986oQRJgD','Vbeln','match','...','‚úÖ\x20API\x20Response\x20Received.\x20Length:','Werks','config','üìå\x20Final\x20Processed\x20Invoices:','object','error','197054dwQLts','üöÄ\x20Starting\x20Sales\x20Invoice\x20Data\x20Sync...','4358775hJImJd','Error\x20inserting\x20or\x20updating\x20sales\x20invoice\x20data','log','application/json','Vkorg','SALES_INVOICE','message','axios','failedRows','1733984zWejmp','processedRows','Empty\x20response\x20from\x20API','isArray','stringify','length','Fkart','‚ùå\x20API\x20Response\x20Format\x20Incorrect:','toString','SAP\x20API\x20Error:\x20','5020821vgtkPQ','Aubel','replace','13thNPNC','18425cUBhjV','‚ùå\x20Error\x20fetching\x20SAP\x20sales\x20invoice\x20data:','Internal\x20Server\x20Error','results','env','get','json','‚úÖ\x20Sales\x20Invoice\x20Data\x20Sync\x20Completed\x20Successfully','filter','\x20sales\x20invoices...','Netwr','Posnr','üìå\x20API\x20Response\x20Data:','Matkl','5CeNeeS','No\x20sales\x20invoice\x20data\x20found\x20in\x20SAP','Spart','‚ö†Ô∏è\x20No\x20valid\x20sales\x20invoice\x20data\x20received.','15710GXqhww'];a5_0x3dd1=function(){return _0x221194;};return a5_0x3dd1();}