const a10_0x3a4786=a10_0xeb1e;function a10_0xeb1e(_0xa18b6,_0x4c4ecd){const _0x139d50=a10_0x139d();return a10_0xeb1e=function(_0xeb1e81,_0x4220a7){_0xeb1e81=_0xeb1e81-0xd9;let _0x3c2db3=_0x139d50[_0xeb1e81];return _0x3c2db3;},a10_0xeb1e(_0xa18b6,_0x4c4ecd);}(function(_0x4bd5ed,_0x293858){const _0x227cab=a10_0xeb1e,_0x248377=_0x4bd5ed();while(!![]){try{const _0x3a46c9=-parseInt(_0x227cab(0xf4))/0x1+-parseInt(_0x227cab(0xe5))/0x2*(parseInt(_0x227cab(0x112))/0x3)+-parseInt(_0x227cab(0x102))/0x4*(-parseInt(_0x227cab(0x115))/0x5)+-parseInt(_0x227cab(0xf9))/0x6*(parseInt(_0x227cab(0x107))/0x7)+parseInt(_0x227cab(0xe6))/0x8+-parseInt(_0x227cab(0xe4))/0x9+parseInt(_0x227cab(0xf0))/0xa*(parseInt(_0x227cab(0x104))/0xb);if(_0x3a46c9===_0x293858)break;else _0x248377['push'](_0x248377['shift']());}catch(_0x537246){_0x248377['push'](_0x248377['shift']());}}}(a10_0x139d,0xf3c9b));function a10_0x139d(){const _0x492846=['28348463bmWHhk','type','❌\x20Error\x20upserting\x20data\x20into\x20\x27','3222296ujPnBZ','length','isInteger','NVarChar','Int','MAX','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20NOT\x20MATCHED\x20THEN\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20INSERT\x20(',']\x20=\x20@param','input','commit','parse','2140677HViuLg','\x27\x20checked/created\x20successfully.','message','10115mVcuWj','param','log','error','\x20AS\x20target\x0a\x20\x20\x20\x20\x20\x20\x20\x20USING\x20(SELECT\x20','⚠️\x20No\x20data\x20to\x20insert/update\x20for\x20\x27','join','\x27,\x20skipping\x20table\x20creation.','keys',');\x0a\x20\x20\x20\x20','VarChar','🔍\x20Inspecting\x20API\x20Data\x20for\x20\x27','17297973PuEJhu','2BnHBSN','4670576yNATNW','✅\x20Upsert\x20operation\x20successful\x20for\x20\x27',');\x0a\x20\x20\x20\x20\x20\x20','execute','filter','string','../config/db','object','Transaction','warn','10SNYotv',']\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHEN\x20MATCHED\x20THEN\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20UPDATE\x20SET\x20','@param',')\x20AS\x20source\x20(','581743mEwxPD','prepare','unprepare','name','stringify','6iAKzCU','reduce','⚠️\x20Converting\x20object\x20to\x20JSON\x20string:','❌\x20No\x20columns\x20found\x20in\x20API\x20data\x20for\x20\x27','begin','isArray','number','DateTime','Decimal','2996msYRIA','map'];a10_0x139d=function(){return _0x492846;};return a10_0x139d();}const {sql,poolPromise}=require(a10_0x3a4786(0xec)),inferSQLType=_0x360091=>{const _0x2b6161=a10_0x3a4786;if(_0x360091===null||_0x360091===undefined)return sql['VarChar'](sql[_0x2b6161(0x10c)]);if(typeof _0x360091===_0x2b6161(0xeb))return _0x360091[_0x2b6161(0x108)]>0xff?sql['Text']:sql[_0x2b6161(0xe2)](0xff);if(typeof _0x360091===_0x2b6161(0xff))return Number[_0x2b6161(0x109)](_0x360091)?sql[_0x2b6161(0x10b)]:sql[_0x2b6161(0x101)](0x12,0x2);if(typeof _0x360091==='boolean')return sql['Bit'];if(_0x360091 instanceof Date||!isNaN(Date[_0x2b6161(0x111)](_0x360091)))return sql[_0x2b6161(0x100)];if(typeof _0x360091===_0x2b6161(0xed))return console['warn'](_0x2b6161(0xfb),_0x360091),sql[_0x2b6161(0x10a)](sql[_0x2b6161(0x10c)]);return sql['NVarChar'](sql[_0x2b6161(0x10c)]);},createTableIfNotExists=async(_0x56b74f,_0x67f8c6)=>{const _0x1862bb=a10_0x3a4786;try{if(!Array[_0x1862bb(0xfe)](_0x67f8c6)||_0x67f8c6[_0x1862bb(0x108)]===0x0){console['warn']('⚠️\x20No\x20data\x20received\x20for\x20\x27'+_0x56b74f+_0x1862bb(0xdf));return;}console[_0x1862bb(0xda)](_0x1862bb(0xe3)+_0x56b74f+'\x27:',JSON[_0x1862bb(0xf8)](_0x67f8c6,null,0x2));const _0x2aa105=await poolPromise,_0x24717b=_0x67f8c6[0x0],_0x30dce0=Object[_0x1862bb(0xe0)](_0x24717b)[_0x1862bb(0x103)](_0x2bd38e=>({'name':_0x2bd38e,'type':inferSQLType(_0x24717b[_0x2bd38e])}));if(_0x30dce0[_0x1862bb(0x108)]===0x0){console['error'](_0x1862bb(0xfc)+_0x56b74f+'\x27.');return;}const _0xda32c9=_0x30dce0[_0x1862bb(0x103)](_0x5b5a11=>'['+_0x5b5a11[_0x1862bb(0xf7)]+']\x20'+_0x5b5a11[_0x1862bb(0x105)])[_0x1862bb(0xde)](',\x20'),_0x5f3c1e='\x0a\x20\x20\x20\x20\x20\x20IF\x20NOT\x20EXISTS\x20(SELECT\x20*\x20FROM\x20INFORMATION_SCHEMA.TABLES\x20WHERE\x20TABLE_NAME\x20=\x20\x27'+_0x56b74f+'\x27)\x0a\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20'+_0x56b74f+'\x20('+_0xda32c9+_0x1862bb(0xe1);await _0x2aa105['request']()['query'](_0x5f3c1e),console['log']('✅\x20Table\x20\x27'+_0x56b74f+_0x1862bb(0x113));}catch(_0x535ab3){console[_0x1862bb(0xdb)]('❌\x20Error\x20creating\x20table\x20\x27'+_0x56b74f+'\x27:',_0x535ab3[_0x1862bb(0x114)]);}},upsertData=async(_0xce1295,_0x252ad6,_0x58e79a)=>{const _0x15a40c=a10_0x3a4786;if(!Array['isArray'](_0x252ad6)||_0x252ad6['length']===0x0){console[_0x15a40c(0xef)](_0x15a40c(0xdd)+_0xce1295+'\x27.');return;}try{const _0x43a7bf=await poolPromise,_0x4712ef=new sql[(_0x15a40c(0xee))](_0x43a7bf);await _0x4712ef[_0x15a40c(0xfd)]();const _0x51c61f=_0x252ad6[0x0],_0x3fdaef=Object[_0x15a40c(0xe0)](_0x51c61f),_0x637b19=_0x3fdaef[_0x15a40c(0xea)](_0xaf5fac=>_0xaf5fac!==_0x58e79a);for(const _0xd2ed71 of _0x252ad6){const _0x28cb87=_0x3fdaef['map'](_0x321dbb=>'['+_0x321dbb+']')['join'](',\x20'),_0x14cdd5=_0x3fdaef[_0x15a40c(0x103)]((_0x42e4b0,_0x58c90d)=>_0x15a40c(0xf2)+_0x58c90d)[_0x15a40c(0xde)](',\x20'),_0x242588=_0x637b19['map']((_0x1ff0ca,_0x1bb748)=>'['+_0x1ff0ca+_0x15a40c(0x10e)+(_0x1bb748+0x1))['join'](',\x20'),_0x43da94='\x0a\x20\x20\x20\x20\x20\x20\x20\x20;MERGE\x20'+_0xce1295+_0x15a40c(0xdc)+_0x14cdd5+_0x15a40c(0xf3)+_0x3fdaef[_0x15a40c(0xde)](',\x20')+')\x0a\x20\x20\x20\x20\x20\x20\x20\x20ON\x20target.['+_0x58e79a+']\x20=\x20source.['+_0x58e79a+_0x15a40c(0xf1)+_0x242588+_0x15a40c(0x10d)+_0x28cb87+')\x20VALUES\x20('+_0x14cdd5+_0x15a40c(0xe8),_0x56701c=new sql['PreparedStatement'](_0x43a7bf);_0x3fdaef['forEach']((_0x3f61a1,_0x8069b3)=>{const _0x197783=_0x15a40c;_0x56701c[_0x197783(0x10f)](_0x197783(0xd9)+_0x8069b3,inferSQLType(_0xd2ed71[_0x3f61a1]));}),await _0x56701c[_0x15a40c(0xf5)](_0x43da94);const _0x4f61a6=_0x3fdaef[_0x15a40c(0xfa)]((_0x47a1ef,_0x463a6f,_0x462b84)=>{const _0xbddc6b=_0x15a40c;return _0x47a1ef[_0xbddc6b(0xd9)+_0x462b84]=_0xd2ed71[_0x463a6f],_0x47a1ef;},{});await _0x56701c[_0x15a40c(0xe9)](_0x4f61a6),await _0x56701c[_0x15a40c(0xf6)]();}await _0x4712ef[_0x15a40c(0x110)](),console['log'](_0x15a40c(0xe7)+_0xce1295+'\x27.');}catch(_0xa7061b){console[_0x15a40c(0xdb)](_0x15a40c(0x106)+_0xce1295+'\x27:',_0xa7061b['message']);}};module['exports']={'createTableIfNotExists':createTableIfNotExists,'upsertData':upsertData};